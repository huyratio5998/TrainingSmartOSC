[
  {
    "Id": "571359",
    "ThreadId": "247380",
    "Html": "\r\n<p>Hey guys</p>\r\n<p>Well i've had some problems with the creation of OrderDetails, and have been trying to solve it, but i don't seem to be able to.<br>\r\nWhen one create an order, the is added info about the customer in the database under the tab &quot;Order&quot;.<br>\r\nBesides that, there SHOULD be added futher info about what album ect. in the &quot;OrderDetails&quot; tab, but the problem is, there isnt.</p>\r\n<p>In my case, there is created all the info in the &quot;Order&quot; tab in the database (except from the &quot;total&quot;).</p>\r\n<p>Now that is what caught my eye, the &quot;total&quot; tab being &quot;0&quot; in all cases.</p>\r\n<p>So what ive come to test around with is the &quot;ShoppingCart&quot; class under Models. The following code pressents the problem, i just cant figure out the problem, or where it is.</p>\r\n<p>&nbsp;</p>\r\n<p>public int CreateOrder(Order order)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\ndecimal orderTotal = 0;<br>\r\n<span style=\"white-space:pre\"></span>var cartItems = GetCartItems();<br>\r\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Iterate over the items in the cart, adding the order details for each&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n<br>\r\n<span style=\"white-space:pre\"></span>foreach (var item in cartItems)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>var orderDetails = new OrderDetail&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>AlbumId = item.AlbumId,&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>OrderId = order.OrderId,&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>UnitPrice = item.Album.Price,&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>Quantity = item.Count&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>};<br>\r\n<br>\r\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// Set the order total of the shopping cart&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>orderTotal &#43;= (item.Count * item.Album.Price);&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br>\r\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>// Set the order's total to the orderTotal count&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>order.Total = orderTotal;<br>\r\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style=\"white-space:pre\"> <br>\r\n</span><span style=\"white-space:pre\"></span>// Save the order&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>storeDB.SaveChanges();<br>\r\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>// Empty the shopping cart&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>EmptyCart();<br>\r\n&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>// Return the OrderId as the confirmation number&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n<span style=\"white-space:pre\"></span>return order.OrderId;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;<br>\r\n}&nbsp;</p>\r\n<p>Like i said, i just can't find the problem, but the is not created anything in the &quot;OrderDetails&quot; tab, in the database, nor is there updated anything about the &quot;total&quot; in the &quot;order&quot; tab.</p>\r\n<p>I really hope someone can help me with this</p>\r\n",
    "PostedDate": "2011-02-24T01:30:55.54-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "591940",
    "ThreadId": "247380",
    "Html": "<p>hi,I just noticed this bug.</p>\r\n<p>you can solve it by add some code below</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>storeDB.OrderDetails.Add(orderDetails);\r\n</pre>\r\n</div>\r\n</p>\r\n<p>the completed CreateOrder code follow behind:</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre> <span style=\"color: blue;\">public</span> <span style=\"color: blue;\">int</span> CreateOrder(Order order)\r\n        {\r\n            <span style=\"color: blue;\">decimal</span> orderTotal = 0;\r\n            <span style=\"color: blue;\">var</span> cartItems = GetCartItems();\r\n            <span style=\"color: blue;\">foreach</span> (<span style=\"color: blue;\">var</span> item <span style=\"color: blue;\">in</span> cartItems)\r\n            {\r\n                <span style=\"color: blue;\">var</span> orderDetails = <span style=\"color: blue;\">new</span> OrderDetail\r\n                {\r\n                    AlbumId = item.AlbumId,\r\n                    OrderId = order.OrderId,\r\n                    UnitPrice = item.Album.Price,\r\n                    Quantity = item.Count\r\n                };\r\n                storeDB.OrderDetails.Add(orderDetails); <span style=\"color: green;\">//add order details to database</span>\r\n                orderTotal += (item.Count * item.Album.Price);\r\n\r\n            }\r\n            order.Total = orderTotal;\r\n            storeDB.SaveChanges();\r\n            EmptyCart();\r\n            <span style=\"color: blue;\">return</span> order.OrderId;\r\n        }\r\n</pre>\r\n</div>\r\n</p>",
    "PostedDate": "2011-04-05T05:12:24.223-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "593147",
    "ThreadId": "247380",
    "Html": "This discussion has been copied to a work item. Click <a href=\"http://mvcmusicstore.codeplex.com/workitem/6637\">here</a> to go to the work item and continue the discussion.",
    "PostedDate": "2011-04-06T15:22:32.73-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]