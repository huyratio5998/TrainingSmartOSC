[
  {
    "Id": "572402",
    "ThreadId": "247638",
    "Html": "\r\n<p>i've spent the past 4 hours debugging and i even went as far to replace whole&nbsp; sections of code from the pre written source and cant figure out why the Album object would come up null\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:green\">//This is in the ShoppingCartController</span>\r\n        <span style=\"color:blue\">public</span> ActionResult AddToCart(<span style=\"color:blue\">int</span> id)\r\n        {\r\n\r\n            <span style=\"color:green\">// Retrieve the album from the database</span>\r\n            <span style=\"color:blue\">var</span> addedAlbum = storeDB.Albums\r\n                .Single(album =&gt; album.AlbumId == id);\r\n\r\n            <span style=\"color:green\">// Add it to the shopping cart</span>\r\n            <span style=\"color:blue\">var</span> cart = ShoppingCart.GetCart(<span style=\"color:blue\">this</span>.HttpContext);\r\n\r\n            cart.AddToCart(addedAlbum);\r\n\r\n            <span style=\"color:green\">// Go back to the main store page for more shopping</span>\r\n            <span style=\"color:blue\">return</span> RedirectToAction(<span style=\"color:#a31515\">&quot;Index&quot;</span>);\r\n        }<br><br><br><div style=\"color:black; background-color:white\"><pre><span style=\"color:green\">//this is in the shopping cart model</span>\r\n        <span style=\"color:blue\">public</span> <span style=\"color:blue\">void</span> AddToCart(Album album)\r\n        {\r\n            <span style=\"color:green\">// Get the matching cart and album instances</span>\r\n            <span style=\"color:blue\">var</span> cartItem = storeDB.Carts.SingleOrDefault(c =&gt; c.CartId == ShoppingCartId &amp;&amp; c.AlbumId == album.AlbumId);\r\n\r\n            <span style=\"color:blue\">if</span> (cartItem == <span style=\"color:blue\">null</span>)\r\n            {\r\n                <span style=\"color:green\">// Create a new cart item if no cart item exists</span>\r\n                cartItem = <span style=\"color:blue\">new</span> Cart\r\n                {\r\n                    AlbumId = album.AlbumId,\r\n                    CartId = ShoppingCartId,\r\n                    Count = 1,\r\n                    DateCreated = DateTime.Now\r\n                };\r\n\r\n                storeDB.Carts.Add(cartItem);\r\n            }\r\n            <span style=\"color:blue\">else</span>\r\n            {\r\n                <span style=\"color:green\">// If the item does exist in the cart, then add one to the quantity</span>\r\n                cartItem.Count&#43;&#43;;\r\n            }\r\n\r\n            <span style=\"color:green\">// Save changes</span>\r\n            storeDB.SaveChanges();\r\n        }\r\n</pre>\r\n</div>\r\n&nbsp;</pre>\r\n</div>\r\nAnd this is my Index.cshtml\r\n<p></p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>@model MvcMusicStore.ViewModels.ShoppingCartViewModel\r\n@{\r\n    ViewBag.Title = <span style=\"color:#a31515\">&quot;Shopping Cart&quot;</span>;\r\n}\r\n&lt;script src=<span style=\"color:#a31515\">&quot;/Scripts/jquery-1.4.4.min.js&quot;</span> type=<span style=\"color:#a31515\">&quot;text/javascript&quot;</span>&gt;&lt;/script&gt;\r\n&lt;script type=<span style=\"color:#a31515\">&quot;text/javascript&quot;</span>&gt;\r\n    $(function () {\r\n        $(<span style=\"color:#a31515\">&quot;.RemoveLink&quot;</span>).click(function () {\r\n            <span style=\"color:blue\">var</span> recordToDelete = $(<span style=\"color:blue\">this</span>).attr(<span style=\"color:#a31515\">&quot;data-id&quot;</span>);\r\n\r\n            <span style=\"color:blue\">if</span> (recordToDelete != <span style=\"color:#a31515\">''</span>) {\r\n                $.post(<span style=\"color:#a31515\">&quot;/ShoppingCart/RemoveFromCart&quot;</span>, { <span style=\"color:#a31515\">&quot;id&quot;</span>: recordToDelete },\r\n                    function (data) {\r\n                        <span style=\"color:blue\">if</span> (data.ItemCount == 0) {\r\n                            $(<span style=\"color:#a31515\">'#row-'</span> &#43; data.DeleteId).fadeOut(<span style=\"color:#a31515\">'slow'</span>);\r\n                        } <span style=\"color:blue\">else</span> {\r\n                            $(<span style=\"color:#a31515\">'#item-count-'</span> &#43; data.DeleteId).text(data.ItemCount);\r\n                        }\r\n\r\n                        $(<span style=\"color:#a31515\">'#cart-total'</span>).text(data.CartTotal);\r\n                        $(<span style=\"color:#a31515\">'#update-message'</span>).text(data.Message);\r\n                        $(<span style=\"color:#a31515\">'#cart-status'</span>).text(<span style=\"color:#a31515\">'Cart ('</span> &#43; data.CartCount &#43; <span style=\"color:#a31515\">')'</span>);\r\n                    });\r\n            }\r\n        });\r\n    });\r\n\r\n    function handleUpdate() {\r\n        <span style=\"color:blue\">var</span> json = context.get_data();\r\n        <span style=\"color:blue\">var</span> data = Sys.Serialization.JavaScriptSerializer.deserialize(json);\r\n\r\n        <span style=\"color:blue\">if</span> (data.ItemCount == 0) {\r\n            $(<span style=\"color:#a31515\">'#row-'</span> &#43; data.DeleteId).fadeOut(<span style=\"color:#a31515\">'slow'</span>);\r\n        } <span style=\"color:blue\">else</span> {\r\n            $(<span style=\"color:#a31515\">'#item-count-'</span> &#43; data.DeleteId).text(data.ItemCount);\r\n        }\r\n\r\n        $(<span style=\"color:#a31515\">'#cart-total'</span>).text(data.CartTotal);\r\n        $(<span style=\"color:#a31515\">'#update-message'</span>).text(data.Message);\r\n        $(<span style=\"color:#a31515\">'#cart-status'</span>).text(<span style=\"color:#a31515\">'Cart ('</span> &#43; data.CartCount &#43; <span style=\"color:#a31515\">')'</span>);\r\n    }\r\n&lt;/script&gt;\r\n&lt;h3&gt;\r\n    &lt;em&gt;Review&lt;/em&gt; your cart:\r\n&lt;/h3&gt;\r\n&lt;p <span style=\"color:blue\">class</span>=<span style=\"color:#a31515\">&quot;button&quot;</span>&gt;\r\n    @Html.ActionLink(<span style=\"color:#a31515\">&quot;Checkout &gt;&gt;&quot;</span>, <span style=\"color:#a31515\">&quot;AddressAndPayment&quot;</span>, <span style=\"color:#a31515\">&quot;Checkout&quot;</span>)\r\n&lt;/p&gt;\r\n&lt;div id=<span style=\"color:#a31515\">&quot;update-message&quot;</span>&gt;\r\n&lt;/div&gt;\r\n&lt;table&gt;\r\n    &lt;tr&gt;\r\n        &lt;th&gt;\r\n            Album Name\r\n        &lt;/th&gt;\r\n        &lt;th&gt;\r\n            Price (each)\r\n        &lt;/th&gt;\r\n        &lt;th&gt;\r\n            Quantity\r\n        &lt;/th&gt;\r\n        &lt;th&gt;\r\n        &lt;/th&gt;\r\n    &lt;/tr&gt;\r\n    @<span style=\"color:blue\">foreach</span> (<span style=\"color:blue\">var</span> item <span style=\"color:blue\">in</span> Model.CartItems)\r\n    {\r\n        &lt;tr id=<span style=\"color:#a31515\">&quot;row-@item.RecordId&quot;</span>&gt;\r\n            &lt;td&gt;\r\n                @Html.ActionLink(item.Album.Title, <span style=\"color:#a31515\">&quot;Details&quot;</span>, <span style=\"color:#a31515\">&quot;Store&quot;</span>, <span style=\"color:blue\">new</span> { id = item.AlbumId }, <span style=\"color:blue\">null</span>)\r\n            &lt;/td&gt;\r\n            &lt;td&gt;\r\n                @item.Album.Price\r\n            &lt;/td&gt;\r\n            &lt;td id=<span style=\"color:#a31515\">&quot;item-count-@item.RecordId&quot;</span>&gt;\r\n                @item.Count\r\n            &lt;/td&gt;\r\n            &lt;td&gt;\r\n                &lt;a href=<span style=\"color:#a31515\">&quot;#&quot;</span> <span style=\"color:blue\">class</span>=<span style=\"color:#a31515\">&quot;RemoveLink&quot;</span> data-id=<span style=\"color:#a31515\">&quot;@item.RecordId&quot;</span>&gt;Remove From Cart&lt;/a&gt;\r\n            &lt;/td&gt;\r\n        &lt;/tr&gt;\r\n    }\r\n    &lt;tr&gt;\r\n        &lt;td&gt;\r\n            Total\r\n        &lt;/td&gt;\r\n        &lt;td&gt;\r\n        &lt;/td&gt;\r\n        &lt;td&gt;\r\n        &lt;/td&gt;\r\n        &lt;td id=<span style=\"color:#a31515\">&quot;cart-total&quot;</span>&gt;\r\n            @Model.CartTotal\r\n        &lt;/td&gt;\r\n    &lt;/tr&gt;\r\n&lt;/table&gt;\r\n\r\n</pre>\r\n</div>\r\ni keep getting the nullref on the foreach loop in the cshtml but i can't figure out why...\r\n<p></p>\r\n",
    "PostedDate": "2011-02-25T17:19:52.59-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "572405",
    "ThreadId": "247638",
    "Html": "<p>oh and this is the exception detail that im getting in Visual Studio</p>\r\n<p>System.NullReferenceException was unhandled by user code<br />&nbsp; Message=Object reference not set to an instance of an object.<br />&nbsp; Source=App_Web_q2teq0hr<br />&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at ASP._Page_Views_ShoppingCart_Index_cshtml.Execute() in c:\\Users\\Administrator\\Documents\\Visual Studio 2010\\Projects\\MvcMusicStore\\MvcMusicStore\\Views\\ShoppingCart\\Index.cshtml:line 65<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.WebPages.WebPageBase.ExecutePageHierarchy()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Mvc.WebViewPage.ExecutePageHierarchy()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.WebPages.StartPage.RunPage()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.WebPages.StartPage.ExecutePageHierarchy()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Mvc.RazorView.RenderView(ViewContext viewContext, TextWriter writer, Object instance)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Mvc.BuildManagerCompiledView.Render(ViewContext viewContext, TextWriter writer)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Mvc.ControllerActionInvoker.&lt;&gt;c__DisplayClass1c.&lt;InvokeActionResultWithFilters&gt;b__19()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation)<br />&nbsp; InnerException:</p>\r\n<p>&nbsp;</p>\r\n<p>And this is what i get in the browser</p>\r\n<p>SourceError:</p>\r\n<p><span style=\"font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;\">\r\n<pre>Line 63:         &lt;/th&gt;\r\nLine 64:     &lt;/tr&gt;\r\n<span style=\"color: red;\">Line 65:     @foreach (var item in Model.CartItems)\r\n</span>Line 66:     {\r\nLine 67:         &lt;tr id=\"row-@item.RecordId\"&gt;</pre>\r\n</span></p>\r\n<p>stacktrace:</p>\r\n<p><span style=\"font-family: Arial,Helvetica,Geneva,SunSans-Regular,sans-serif;\">\r\n<pre>[NullReferenceException: Object reference not set to an instance of an object.]\r\n   ASP._Page_Views_ShoppingCart_Index_cshtml.Execute() in c:\\Users\\Administrator\\Documents\\Visual Studio 2010\\Projects\\MvcMusicStore\\MvcMusicStore\\Views\\ShoppingCart\\Index.cshtml:65\r\n   System.Web.WebPages.WebPageBase.ExecutePageHierarchy() +207\r\n   System.Web.Mvc.WebViewPage.ExecutePageHierarchy() +81\r\n   System.Web.WebPages.StartPage.RunPage() +19\r\n   System.Web.WebPages.StartPage.ExecutePageHierarchy() +65\r\n   System.Web.WebPages.WebPageBase.ExecutePageHierarchy(WebPageContext pageContext, TextWriter writer, WebPageRenderingBase startPage) +76\r\n   System.Web.Mvc.RazorView.RenderView(ViewContext viewContext, TextWriter writer, Object instance) +220\r\n   System.Web.Mvc.BuildManagerCompiledView.Render(ViewContext viewContext, TextWriter writer) +115\r\n   System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) +303\r\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult) +13\r\n   System.Web.Mvc.&lt;&gt;c__DisplayClass1c.&lt;InvokeActionResultWithFilters&gt;b__19() +23\r\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +260\r\n   System.Web.Mvc.&lt;&gt;c__DisplayClass1e.&lt;InvokeActionResultWithFilters&gt;b__1b() +19\r\n   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +177\r\n   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343\r\n   System.Web.Mvc.Controller.ExecuteCore() +116\r\n   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97\r\n   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10\r\n   System.Web.Mvc.&lt;&gt;c__DisplayClassb.&lt;BeginProcessRequest&gt;b__5() +37\r\n   System.Web.Mvc.Async.&lt;&gt;c__DisplayClass1.&lt;MakeVoidDelegate&gt;b__0() +21\r\n   System.Web.Mvc.Async.&lt;&gt;c__DisplayClass8`1.&lt;BeginSynchronous&gt;b__7(IAsyncResult _) +12\r\n   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62\r\n   System.Web.Mvc.&lt;&gt;c__DisplayClasse.&lt;EndProcessRequest&gt;b__d() +50\r\n   System.Web.Mvc.SecurityUtil.&lt;GetCallInAppTrustThunk&gt;b__0(Action f) +7\r\n   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22\r\n   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60\r\n   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9\r\n   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8841169\r\n   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +184</pre>\r\n</span></p>",
    "PostedDate": "2011-02-25T17:24:02.823-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "572409",
    "ThreadId": "247638",
    "Html": "<p>Can you check your StoreController Index method to make sure it's assigning the CartItems? You've pasted in the AddToCart method, but not Index. It should look like this:</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre>        <span style=\"color: green;\">//</span>\n        <span style=\"color: green;\">// GET: /ShoppingCart/</span>\n\n        <span style=\"color: blue;\">public</span> ActionResult Index()\n        {\n            <span style=\"color: blue;\">var</span> cart = ShoppingCart.GetCart(<span style=\"color: blue;\">this</span>.HttpContext);\n\n            <span style=\"color: green;\">// Set up our ViewModel</span>\n            <span style=\"color: blue;\">var</span> viewModel = <span style=\"color: blue;\">new</span> ShoppingCartViewModel\n            {\n                <span style=\"color: #ff0000;\"><strong>CartItems = cart.GetCartItems(),</strong></span>\n                CartTotal = cart.GetTotal()\n            };\n\n            <span style=\"color: green;\">// Return the view</span>\n            <span style=\"color: blue;\">return</span> View(viewModel);\n        }\n</pre>\n</div>",
    "PostedDate": "2011-02-25T17:42:22.593-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "572410",
    "ThreadId": "247638",
    "Html": "<p>i think i forgot thevirwmodel in the return.,,,, ill try it and post results</p>\n<p>&nbsp;</p>\n<p>im an idiot sloved thanks... i forgot to review every part of my code and forgot to pass viewModel into the View</p>",
    "PostedDate": "2011-02-25T17:54:56.4-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]