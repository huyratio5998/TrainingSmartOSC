[
  {
    "Id": "512089",
    "ThreadId": "232201",
    "Html": "\r\n<p>This bug is present in all version of MvcMusicStore.</p>\r\n<p>the code of RemoveFromCart in ShoppingCart Model is:</p>\r\n<p>&nbsp;public void RemoveFromCart(int id)<br>\r\n{<br>\r\n//Get the cart<br>\r\nvar cartItem = storeDB.Carts.Single(<br>\r\ncart =&gt; cart.CartId == shoppingCartId<br>\r\n&nbsp;&amp;&amp; cart.RecordId == id);<br>\r\nif (cartItem != null)<br>\r\n{<br>\r\nif (cartItem.Count &gt; 1)<br>\r\n{<br>\r\ncartItem.Count--;<br>\r\n}<br>\r\nelse<br>\r\n{<br>\r\nstoreDB.Carts.DeleteObject(cartItem);<br>\r\n}<br>\r\nstoreDB.SaveChanges();<br>\r\n}<br>\r\n}</p>\r\n<p>This mean you are removing record one by one. For example, if you have 3 items in 1 record, and you make a &quot;Remove from cart&quot; action, this will keep 2 item in your cart</p>\r\n<p>But the Javascript code in ShoppingCart View is:</p>\r\n<p>&lt;script type=&quot;text/javascript&quot;&gt;<br>\r\nfunction handleUpdate(context) {</p>\r\n<p>// Load and deserialize the returned JSON data<br>\r\nvar json = context.get_data();<br>\r\n&nbsp;var data = Sys.Serialization.JavaScriptSerializer.deserialize(json);</p>\r\n<p>&nbsp;// Update the page elements<br>\r\n<span style=\"color:#ff0000\">$('#row-' &#43; data.DeleteId).fadeOut('slow');</span><br>\r\n$('#cart-status').text('Cart (' &#43; data.CartCount &#43; ')');</p>\r\n<p>$('#update-message').text(data.Message);<br>\r\n$('#cart-total').text(data.CartTotal);<br>\r\n}<br>\r\n&lt;/script&gt;</p>\r\n<p>This will delete an entire row. If you make a F5 press, you will see that remain 2 items in that record.</p>\r\n<p>The correct Javascript code is:</p>\r\n<p>var json = context.get_data();<br>\r\nvar data = Sys.Serialization.JavaScriptSerializer.deserialize(json);<br>\r\nvar count = data.Count;<br>\r\n<span style=\"color:#ff0000\">if (count == 0) {</span><br>\r\n<span style=\"color:#ff0000\">$('#row-' &#43; data.DeletedId).fadeOut('slow');</span><br>\r\n<span style=\"color:#ff0000\">} else {</span><br>\r\n<span style=\"color:#ff0000\">&nbsp;$('#cell-'&#43;data.DeletedId).text(count);</span><br>\r\n<span style=\"color:#ff0000\">&nbsp;} &nbsp;</span><br>\r\n&nbsp;with count is the quantity of albums in this record.</p>\r\n",
    "PostedDate": "2010-10-25T05:52:16.92-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "512437",
    "ThreadId": "232201",
    "Html": "\r\n<p>Thanks, great catch! Originally we didn't track quantity with orders, and it looks like I didn't update the Javascript with that change. Will get this in the next release.</p>\r\n",
    "PostedDate": "2010-10-25T16:12:48.7-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "512446",
    "ThreadId": "232201",
    "Html": "This discussion has been copied to a work item. Click <a href=\"http://mvcmusicstore.codeplex.com/workitem/6613\">here</a> to go to the work item and continue the discussion.",
    "PostedDate": "2010-10-25T16:31:18.497-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]