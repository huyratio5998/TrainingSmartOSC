[
  {
    "Id": "542214",
    "ThreadId": "240015",
    "Html": "\r\n<p>This bug occured when you add 2 or more same album to the cart.</p>\r\n<p>when you remove one, the entry item will be deleted, it should decrease the quantity only.</p>\r\n<p>&nbsp;</p>\r\n<p>here is the way to&nbsp;fix this bug that I used.</p>\r\n<p>add a property in ShoppingCartRemoveViewModel</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">public</span> <span style=\"color:blue\">int</span> TheAlbumCount { <span style=\"color:blue\">get</span>; <span style=\"color:blue\">set</span>; }\r\n</pre>\r\n</div>\r\n<p>then&nbsp;</p>\r\n<p>get the count and return it to client by json in ShoppingCartController.cs</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>        [HttpPost]\r\n        <span style=\"color:blue\">public</span> ActionResult RemoveFromCart(<span style=\"color:blue\">int</span> id)\r\n        {\r\n            <span style=\"color:green\">// Remove the item from the cart</span>\r\n            <span style=\"color:blue\">var</span> cart = ShoppingCart.GetCart(<span style=\"color:blue\">this</span>.HttpContext);\r\n            <span style=\"color:green\">// Get the name of the album to display confirmation</span>\r\n            <span style=\"color:blue\">string</span> albumName = storeDB.Carts\r\n                .Single(item =&gt; item.RecordId == id).Album.Title;\r\n            <span style=\"color:green\">//Patch!</span>\r\n            <span style=\"color:blue\">int</span> albumCount = storeDB.Carts\r\n                .Single(item =&gt; item.RecordId == id).Count;\r\n            <span style=\"color:green\">// Remove from cart. Note that for simplicity, we're </span>\r\n            <span style=\"color:green\">// removing all rather than decrementing the count.</span>\r\n            cart.RemoveFromCart(id);\r\n            <span style=\"color:green\">// Display the confirmation message</span>\r\n            <span style=\"color:blue\">var</span> results = <span style=\"color:blue\">new</span> ShoppingCartRemoveViewModel\r\n            {\r\n                Message = Server.HtmlEncode(albumName) &#43;\r\n                    <span style=\"color:#a31515\">&quot; has been removed from your shopping cart.&quot;</span>,\r\n                CartTotal = cart.GetTotal(),\r\n                CartCount = cart.GetCount(),\r\n                DeleteId = id,\r\n                <span style=\"color:green\">//Patch!</span>\r\n                TheAlbumCount = --albumCount\r\n            };\r\n            <span style=\"color:blue\">return</span> Json(results);\r\n        }\r\n</pre>\r\n</div>\r\n<p>finally, update the view:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>            // replace this $('#row-' &#43; data.DeleteId).fadeOut('slow'); as follow\r\n            if (data.TheAlbumCount == 0) {\r\n                $('#row-' &#43; data.DeleteId).fadeOut('slow');\r\n            } else {\r\n                $('#albumcount-' &#43; data.DeleteId).text(data.TheAlbum);\r\n            }\r\n... \r\n           <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\n                <span style=\"color:green\">&lt;!--Patch!--&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">div</span> <span style=\"color:red\">id</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;albumcount-&lt;%: item.RecordId %&gt;&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"background-color:yellow\">&lt;%</span>: item.Count <span style=\"background-color:yellow\">%&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">div</span><span style=\"color:blue\">&gt;</span>\r\n            <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">td</span><span style=\"color:blue\">&gt;</span>\r\nit seems works fine now.</pre>\r\n</div>\r\n",
    "PostedDate": "2010-12-30T09:13:37.503-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "553598",
    "ThreadId": "240015",
    "Html": "\r\n<p>It doesn't work as the grid does not get updated!</p>\r\n<p>Could someone help</p>\r\n",
    "PostedDate": "2011-01-22T03:50:34.797-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]